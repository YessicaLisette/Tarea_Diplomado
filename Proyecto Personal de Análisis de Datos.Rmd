---
Titulo: "Tarea Diplomado en R"
Autor: "Yessica Ortega Asencios"
Fecha: "24 mayo 2022"
output: html_document
---

## Titulo: 
Evaluación del efecto del aceite de orégano sobre los índices de productividad en trucha arcoíris (*Oncorhynchus mykiss*) en Perú.

## Autor: 
Yessica Ortega Asencios

## Problema a revisar: 
El objetivo del estudio fue evaluar el efecto de un producto comercial a base de aceite de orégano sobre los parámetros productivos en trucha arco iris. Se utilizaron 1500 truchas provenientes de la Universidad Nacional del Altiplano de Puno - Perú. Los peces fueron distribuidos en dos grupos (250 cada uno), con inclusión del producto en la dieta a dos concentraciones (T1 = 0.3 g/kg y T2 = 0.5 g/kg) y un grupo control (G.C = 0). Se utilizaron tres repeticiones por cada grupo.

## Variables:
### Independiente:
Aceite de orégano

### Dependientes: 
Peso, Talla y Mortalidad


## Análisis exploratorio
### Instalar paquetes
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(readxl)
library(ggplot2)
library(ggpubr)
library(dplyr)
library(psych)
```

## Cargar archivos
```{r}
Datos_biometría<-read_excel("Datos biometría.xlsx", sheet=1)
head(Datos_biometría)
str(Datos_biometría)
tail(Datos_biometría)
summary(Datos_biometría)

Datos_biometría$Pez<-as.factor(Datos_biometría$Pez)
Datos_biometría$Dosis<-as.factor(Datos_biometría$Dosis)
Datos_biometría$N_Biom<-as.factor(Datos_biometría$N_Biom)
Datos_biometría$N_Estanque<-as.factor(Datos_biometría$N_Estanque)
summary(Datos_biometría)
```

## Filtrar y explorar datos
```{r}
knitr::opts_chunk$set(echo = TRUE)
Biom_1<-Datos_biometría%>%filter(N_Biom=="1")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_2<-Datos_biometría%>%filter(N_Biom=="2")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_3<-Datos_biometría%>%filter(N_Biom=="3")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_4<-Datos_biometría%>%filter(N_Biom=="4")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_5<-Datos_biometría%>%filter(N_Biom=="5")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_6<-Datos_biometría%>%filter(N_Biom=="6")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_7<-Datos_biometría%>%filter(N_Biom=="7")%>%select(Dosis,N_Estanque,Peso,Talla)
Biom_8<-Datos_biometría%>%filter(N_Biom=="8")%>%select(Dosis,N_Estanque,Peso,Talla)

table(Biom_1$Peso)
table(Biom_8$Dosis)
table(Biom_6$N_Estanque)
table(Biom_7$Talla)

Data_1<-Biom_1%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
            Promedio_Peso = mean(Peso, na.rm=T), 
            Promedio_Talla =mean(Talla, na.rm=T))

Data_2<-Biom_2%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(),
            Promedio_Peso = mean(Peso, na.rm=T), 
            Promedio_Talla =mean(Talla, na.rm=T))

Data_3<-Biom_3%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
            Promedio_Peso = mean(Peso, na.rm=T), 
            Promedio_Talla =mean(Talla, na.rm=T))
Data_4<-Biom_4%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
           Promedio_Peso = mean(Peso, na.rm=T), 
           Promedio_Talla =mean(Talla, na.rm=T))

Data_5<-Biom_5%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
           Promedio_Peso = mean(Peso, na.rm=T), 
           Promedio_Talla =mean(Talla, na.rm=T))

Data_6<-Biom_6%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
           Promedio_Peso = mean(Peso, na.rm=T), 
           Promedio_Talla =mean(Talla, na.rm=T))

Data_7<-Biom_7%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
           Promedio_Peso = mean(Peso, na.rm=T), 
           Promedio_Talla =mean(Talla, na.rm=T))

Data_8<-Biom_8%>%group_by(Dosis, N_Estanque)%>%summarize(n = n(), 
            Promedio_Peso = mean(Peso, na.rm=T), 
            Promedio_Talla =mean(Talla, na.rm=T))

table(Data_1$Promedio_Peso)
table(Data_8$Promedio_Peso)
```

## Gráficos: Densidad y distribución acumulada empírica
```{r biometría, echo=TRUE}
plot(density(Biom_6$Peso))
plot(density(Biom_7$Talla))
plot(density(Data_8$Promedio_Peso))
plot(density(Data_8$Promedio_Talla))

plot(ecdf(Data_3$Promedio_Talla), main="Distribución acumulada empírica", xlab="Talla Promedio (cm)")
plot(ecdf(Data_5$Promedio_Peso), main="Distribución acumulada empírica", xlab="Peso Promedio (g)")
```

## Explorando los datos
```{r}
knitr::opts_chunk$set(echo = TRUE)
hist(Biom_8$Peso, col="#FA8072", main="Histograma de Peso_8", las=1, xlab="Peso (g)", 
     ylab="Frecuencia")

hist(Biom_7$Talla, col="#4EEE94", main="Histograma de Talla_7", las=1, xlab="Talla (cm)", 
     ylab="Frecuencia")

hist(Data_8$Promedio_Peso, col="#FFD700", main="Histograma de Promedio Peso_8", las=1,
     xlab="Promedio Peso (g)", ylab="Frecuencia")

hist(Data_8$Promedio_Talla, col="#EE3B3B", main="Histograma de Promedio Talla_8", las=1,
     xlab="Promedio Talla (cm)", ylab="Frecuencia")

ggplot(Data_8, aes(Promedio_Peso))+
  geom_histogram(bins=8, color="#858585", fill="#ADFF2F")+
  labs(title="Histograma", x="Promedio de Peso", 
       y="Frecuencia")

ggplot(Data_8, aes(Promedio_Talla))+
  geom_histogram(bins=8, color="#00008B", fill="#1874CD")+
  labs(title="Histograma", x="Promedio de Talla", 
       y="Frecuencia")


boxplot(formula = Peso ~ Dosis,
        data =  Biom_1, col=c("#D2691E","#7FFFD4","#FFD700"))


boxplot(formula = Talla ~ Dosis, 
        data=Biom_1, col=c("#D2691E","#7FFFD4","#FFD700"))

boxplot(formula = Peso ~ Dosis, 
        data=Biom_8, col=c("#636363","#FF3030","#00FFFF"))

boxplot(formula = Talla ~ Dosis, 
        data=Biom_8, col=c("#FFA07A","#242424","#C0FF3E"))

ggplot(Biom_8, aes(x=Dosis, y=Peso, fill=N_Estanque)) +
  geom_boxplot()+
  labs(y="Peso")

ggplot(Biom_8, aes(x=Dosis, y=Talla, fill=N_Estanque)) +
  geom_boxplot()+
  labs(y="Talla")

ggboxplot(Biom_7, x= "Dosis", y
          ="Talla",col= 1, ylab="Talla (cm)",
          xlab="Dosis", notch = F, add.params = list(color = c("cadetblue")), add="jitter")
```

## Gráfica de dispersión, interacción y correlación
```{r}
knitr::opts_chunk$set(echo = TRUE)
plot(x = Data_1$Promedio_Peso, y = Data_1$Promedio_Talla, col = Data_1$Dosis, 
     main = "Peso - Talla", xlab = "Peso", ylab = "Talla")
legend(x = "topleft", legend = c("GC", "T1", "T2"), 
       fill = c("black", "red", "green"), title = "Promedio Peso vs Promedio Talla")

pairs.panels(Data_8[,4:5], method = "pearson", hist.col = "#FFA500",  density = TRUE, font=2)
```

## Generando tablas
```{r}
knitr::opts_chunk$set(echo = TRUE)
library(DT)
datatable(Data_8, caption = "Peso y Talla promedio en función de la Dosis.") 
```


